<html><head><title> Wasm_of_ocaml </title><meta charset="utf8"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="stylesheet" href="https://ocsigen.org/css/style.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/themes/prism.min.css"/><script type="application/javascript" src="https://ocsigen.org/js/client.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-core.min.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-ocaml.min.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-clike.min.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-reason.min.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-javascript.min.js">
//<![CDATA[

//]]>
</script></head><body class="wasm_overview js_of_ocaml"><div class="project-page"><div class="page-header"><p class="logo-ocsigen"><a href=".././../../" class="ocsimore_phrasing_link"><img src=".././../../img/ocsigen-white.svg" alt="Ocsigen"/></a>
</p><p class="logo-subproject">Js_of_ocaml</p><div class="mainmenu"><p class="mainmenu-home"><a href=".././../../" class="ocsimore_phrasing_link">Home</a></p><p class="mainmenu-doc"><a href=".././../../tuto/" class="ocsimore_phrasing_link">Doc</a></p><p><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a></p><p class="mainmenu-current"><a href=".././../../js_of_ocaml/" class="ocsimore_phrasing_link">Js_of_ocaml</a></p><p><a href=".././../../ocsigenserver/" class="ocsimore_phrasing_link">Server</a></p><p><a href=".././../../lwt/" class="ocsimore_phrasing_link">Lwt</a></p><p><a href=".././../../tyxml/" class="ocsimore_phrasing_link">Tyxml</a></p><p><a href=".././../../ocsigen-start/" class="ocsimore_phrasing_link">Start</a></p></div><form id="googlesearch" action="https://google.com/search"><input name="q" id="gsearch-box" placeholder="Search using Google"/><label for="gsearch-box"><img src="/img/search.svg" alt="" id="gsearch-icon"/></label><input type="submit" id="gsearch-submit" onclick="document.getElementById('gsearch-box').value += ' site:ocsigen.org';"/></form><aside class="how-drawer"><input id="how-drawer-toggle" type="checkbox"/><label for="how-drawer-toggle" id="how-drawer-label"><span class="how-drawer-icon"></span></label><nav class="how-drawer-content"><ul class="drawermainmenu"><li class="drawermainmenu-home"><a href=".././../../" class="ocsimore_phrasing_link">Home</a>
</li><li class="drawermainmenu-doc"><a href=".././../../tuto/" class="ocsimore_phrasing_link">Doc</a>
</li><li class="drawermainmenu-project"><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a>
</li><li class="drawermainmenu-project"><a href=".././../../js_of_ocaml/" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigenserver/" class="ocsimore_phrasing_link">Server</a>
</li><li class="drawermainmenu-project"><a href=".././../../lwt/" class="ocsimore_phrasing_link">Lwt</a>
</li><li class="drawermainmenu-project"><a href=".././../../tyxml/" class="ocsimore_phrasing_link">Tyxml</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigen-toolkit/" class="ocsimore_phrasing_link">Toolkit</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigen-start/" class="ocsimore_phrasing_link">Start</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsipersist/" class="ocsimore_phrasing_link">Ocsipersist</a>
</li><li class="drawermainmenu-project"><a href=".././../../html_of_wiki/" class="ocsimore_phrasing_link">html_of_wiki</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsimore/" class="ocsimore_phrasing_link">Ocsimore (<em>deprecated</em>)</a>
</li><li class="drawermainmenu-page"><a href=".././../../projects" class="ocsimore_phrasing_link">Other projects</a>
</li><li class="drawermainmenu-page"><a href=".././../../papers" class="ocsimore_phrasing_link">Research papers</a>
</li><li class="drawermainmenu-page"><a href=".././../../credits" class="ocsimore_phrasing_link">Who does Ocsigen?</a>
</li><li class="drawermainmenu-page"><a href=".././../../contributing" class="ocsimore_phrasing_link">Contributing</a>
</li><li class="drawermainmenu-page"><a href=".././../../blog" class="ocsimore_phrasing_link">Blog</a>
</li><li class="drawermainmenu-page"><a href=".././../../install" class="ocsimore_phrasing_link">Installation</a>
</li><li class="drawermainmenu-page"><a href="https://github.com/ocsigen" class="ocsimore_phrasing_link">Source code</a>
</li></ul><nav class="how-doctree"><h1>Js_of_ocaml - Reference Manual</h1><h2><a href="overview" class="ocsimore_phrasing_link">Overview</a></h2><h2><a href="install" class="ocsimore_phrasing_link">Install</a></h2><h2><a href="library" class="ocsimore_phrasing_link">Library overview</a></h2><h2><a href="bindings" class="ocsimore_phrasing_link">Binding a JS library</a></h2><h2><a href="rev-bindings" class="ocsimore_phrasing_link">Export OCaml code to JavaScript</a></h2><h2><a href="environment-variable" class="ocsimore_phrasing_link">Environment variable</a></h2><h2><span><a href=".././api/js_of_ocaml/">API</a></span></h2><h1>Wasm_of_ocaml - Reference Manual</h1><h2><a href="wasm_overview" class="ocsimore_phrasing_link">Overview</a></h2><h2><a href="wasm_runtime" class="ocsimore_phrasing_link">Writing Wasm primitives</a></h2><h1>Js_of_ocaml_lwt - Reference Manual</h1><h2><a href="lwt" class="ocsimore_phrasing_link">Lwt support</a></h2><h2><span><a href=".././api/js_of_ocaml-lwt/">API</a></span></h2><h1>Syntaxes</h1><h2><a href="ppx" class="ocsimore_phrasing_link">Ppx syntax extension</a></h2><h2><a href="ppx-deriving" class="ocsimore_phrasing_link">Ppx deriving json</a></h2><h1>Compiler</h1><h2><a href="options" class="ocsimore_phrasing_link">Command line options</a></h2><h2><a href="linker" class="ocsimore_phrasing_link">Link javascript code</a></h2><h2><a href="separate-compilation" class="ocsimore_phrasing_link">Separate compilation</a></h2><h2><a href="tailcall" class="ocsimore_phrasing_link">About tailcall optimization</a></h2><h2><a href="effects" class="ocsimore_phrasing_link">Effect handlers</a></h2><h1>Misc</h1><h2><a href="runtime-files" class="ocsimore_phrasing_link">How to look up runtime files</a></h2><h2><a href="build-toplevel" class="ocsimore_phrasing_link">How to build a toplevel or use Dynlink</a></h2><h2><a href="debug" class="ocsimore_phrasing_link">How to debug a program</a></h2><h2><a href="contribute" class="ocsimore_phrasing_link">How to contribute</a></h2><h2><a href="performances" class="ocsimore_phrasing_link">Performances</a></h2><h1>Js_of_ocaml examples</h1><h2><span><a href=".././manual/files/toplevel/index.html">An OCaml toplevel running in the browser</a></span></h2><h2><span><a href=".././manual/files/planet/index.html">An animated 3D view of the Earth</a></span></h2><h2><span><a href=".././manual/files/graph_viewer/index.html">A graph viewer</a></span></h2><h2><span><a href=".././manual/files/boulderdash/index.html">A Boulder Dash game</a></span></h2><h2><span><a href=".././manual/files/wiki/index.html">A realtime wiki editor</a></span></h2><h2><span><a href=".././manual/files/webgl/index.html">A webgl demo</a></span></h2><h2><span><a href=".././manual/files/minesweeper/index.html">A Minesweeper game</a></span></h2><h2><span><a href=".././manual/files/hyperbolic/index.html">A hyperbolic tree viewer</a></span></h2><h2><span><a href=".././manual/files/cubes/index.html">A random walk on lozenge tiling configurations</a></span></h2></nav></nav></aside></div><p class="reasonwarning">Warning: Reason support is experimental.
We are looking for beta-tester and contributors.
</p><button id="reason">Switch to </button><div class="twocols"><nav class="leftcol">Version <select class="how-versions" onchange="location = this.value;"><option value=".././../dev/manual/wasm_overview">dev</option><option value=".././../6.2.0/manual/wasm_overview">6.2.0</option><option value=".././../6.1.0/manual/wasm_overview" selected="selected">6.1.0</option><option value=".././../6.0.1/manual/wasm_overview">6.0.1</option><option value=".././../5.9.1/manual/wasm_overview">5.9.1</option><option value=".././../5.8.2/manual/wasm_overview">5.8.2</option><option value=".././../5.7.2/manual/wasm_overview">5.7.2</option><option value=".././../5.6.0/manual/wasm_overview">5.6.0</option><option value=".././../5.5.2/manual/wasm_overview">5.5.2</option><option value=".././../5.4.0/manual/wasm_overview">5.4.0</option><option value=".././../5.3.0/manual/wasm_overview">5.3.0</option><option value=".././../5.2.0/manual/wasm_overview">5.2.0</option><option value=".././../5.1.0/manual/wasm_overview">5.1.0</option><option value=".././../5.0.1/manual/wasm_overview">5.0.1</option><option value=".././../4.1.0/manual/wasm_overview">4.1.0</option><option value=".././../4.0.0/manual/wasm_overview">4.0.0</option><option value=".././../3.11.0/manual/wasm_overview">3.11.0</option><option value=".././../3.10.0/manual/wasm_overview">3.10.0</option><option value=".././../3.9.0/manual/wasm_overview">3.9.0</option><option value=".././../3.8.0/manual/wasm_overview">3.8.0</option><option value=".././../3.7.0/manual/wasm_overview">3.7.0</option><option value=".././../3.6.0/manual/wasm_overview">3.6.0</option><option value=".././../3.5.1/manual/wasm_overview">3.5.1</option></select><nav class="how-doctree"><h1>Js_of_ocaml - Reference Manual</h1><h2><a href="overview" class="ocsimore_phrasing_link">Overview</a></h2><h2><a href="install" class="ocsimore_phrasing_link">Install</a></h2><h2><a href="library" class="ocsimore_phrasing_link">Library overview</a></h2><h2><a href="bindings" class="ocsimore_phrasing_link">Binding a JS library</a></h2><h2><a href="rev-bindings" class="ocsimore_phrasing_link">Export OCaml code to JavaScript</a></h2><h2><a href="environment-variable" class="ocsimore_phrasing_link">Environment variable</a></h2><h2><span><a href=".././api/js_of_ocaml/">API</a></span></h2><h1>Wasm_of_ocaml - Reference Manual</h1><h2><a href="wasm_overview" class="ocsimore_phrasing_link">Overview</a></h2><h2><a href="wasm_runtime" class="ocsimore_phrasing_link">Writing Wasm primitives</a></h2><h1>Js_of_ocaml_lwt - Reference Manual</h1><h2><a href="lwt" class="ocsimore_phrasing_link">Lwt support</a></h2><h2><span><a href=".././api/js_of_ocaml-lwt/">API</a></span></h2><h1>Syntaxes</h1><h2><a href="ppx" class="ocsimore_phrasing_link">Ppx syntax extension</a></h2><h2><a href="ppx-deriving" class="ocsimore_phrasing_link">Ppx deriving json</a></h2><h1>Compiler</h1><h2><a href="options" class="ocsimore_phrasing_link">Command line options</a></h2><h2><a href="linker" class="ocsimore_phrasing_link">Link javascript code</a></h2><h2><a href="separate-compilation" class="ocsimore_phrasing_link">Separate compilation</a></h2><h2><a href="tailcall" class="ocsimore_phrasing_link">About tailcall optimization</a></h2><h2><a href="effects" class="ocsimore_phrasing_link">Effect handlers</a></h2><h1>Misc</h1><h2><a href="runtime-files" class="ocsimore_phrasing_link">How to look up runtime files</a></h2><h2><a href="build-toplevel" class="ocsimore_phrasing_link">How to build a toplevel or use Dynlink</a></h2><h2><a href="debug" class="ocsimore_phrasing_link">How to debug a program</a></h2><h2><a href="contribute" class="ocsimore_phrasing_link">How to contribute</a></h2><h2><a href="performances" class="ocsimore_phrasing_link">Performances</a></h2><h1>Js_of_ocaml examples</h1><h2><span><a href=".././manual/files/toplevel/index.html">An OCaml toplevel running in the browser</a></span></h2><h2><span><a href=".././manual/files/planet/index.html">An animated 3D view of the Earth</a></span></h2><h2><span><a href=".././manual/files/graph_viewer/index.html">A graph viewer</a></span></h2><h2><span><a href=".././manual/files/boulderdash/index.html">A Boulder Dash game</a></span></h2><h2><span><a href=".././manual/files/wiki/index.html">A realtime wiki editor</a></span></h2><h2><span><a href=".././manual/files/webgl/index.html">A webgl demo</a></span></h2><h2><span><a href=".././manual/files/minesweeper/index.html">A Minesweeper game</a></span></h2><h2><span><a href=".././manual/files/hyperbolic/index.html">A hyperbolic tree viewer</a></span></h2><h2><span><a href=".././manual/files/cubes/index.html">A random walk on lozenge tiling configurations</a></span></h2></nav></nav><article class="rightcol"><h1> Wasm_of_ocaml </h1><h2> Overview </h2><p>Wasm_of_ocaml is a compiler from OCaml bytecode programs to WebAssembly.
It provides an alternative way to run pure OCaml programs in JavaScript environments like browsers and Node.js.
</p><p>The compiler is provided by the wasm_of_ocaml-compiler package. The <span><a href=".././manual/overview">Js_of_ocaml libraries</a></span> are compatible with this compiler.
</p><h2> Installation</h2><p>The easiest way to install wasm_of_ocaml is to use opam.
<span class="teletype">opam install wasm_of_ocaml-compiler js_of_ocaml js_of_ocaml-ppx js_of_ocaml-lwt</span>
</p><h2> Usage </h2><p>Your program must first be compiled using the OCaml bytecode compiler
<span class="teletype">ocamlc</span>.  JavaScript bindings are provided by the <span class="teletype">js_of_ocaml</span>
package and the syntax extension by the <span class="teletype">js_of_ocaml-ppx</span> package.
</p><pre>      ocamlfind ocamlc -package js_of_ocaml -package js_of_ocaml-ppx \
          -linkpkg -o cubes.byte cubes.ml
</pre><p>Then, run the <span class="teletype">wasm_of_ocaml</span> compiler to produce Wasm code:
</p><pre>      wasm_of_ocaml cubes.byte
</pre><p>This produces a Javascript loading script {{{cube.js}} and a directory
{{{cube.assets}} containing the Wasm code.
</p><h3> with dune </h3><p>Dune has native support for wasm_of_ocaml (starting with dune 3.17.0).
It supports both standard and separate compilation. See <a href="https://dune.readthedocs.io/en/latest/wasmoo.html" class="ocsimore_phrasing_link">https://dune.readthedocs.io/en/latest/wasmoo.html</a>
</p><h2> Supported features </h2><p>Most of the OCaml standard library is supported. However,
</p><ul><li> Most of Sys module is not supported.
</li></ul><p>Extra libraries distributed with Ocaml (such as Thread) are not
supported in general. However,
</p><ul><li> Bigarray: bigarrays are supported using Typed Arrays
</li><li> Str: supported
</li><li> Graphics: partially supported using canvas (see also js_of_ocaml-lwt.graphics)
</li><li> Unix: time related functions are supported
</li></ul><p>Compared to Js_of_ocaml, dynlink is not supported, and it is not possible to build an OCaml toplevel. The virtual filesystem is not implemented either.
</p><p>OCaml 5.x code using effect handlers can be compiled in two different ways:
one can enable the CPS transformation from <span class="teletype">js_of_ocaml</span> by passing the
<span class="teletype">--effects=cps</span> flag. Without the flag <span class="teletype">wasm_of_ocaml</span> will instead default to
<span class="teletype">--effects=jspi</span> and emit code utilizing
<a href="https://github.com/WebAssembly/js-promise-integration/blob/main/proposals/js-promise-integration/Overview.md" class="ocsimore_phrasing_link">the JavaScript-Promise Integration extension</a>.
The CPS transformation is not the default since the generated code is slower, larger and less readable. On the other hand, the JSPI extension is not yet enabled by default in Web browsers, and performing effects is slower when using this extension.
</p><h2> Binding with Javascript libraries </h2><p>Js_of_ocaml lets the user bind their code with Javascript libraries by linking in <span class="teletype">.js</span> files. Similarly, wasm_of_ocaml allows to link in Wasm modules (<span class="teletype">.wasm</span> or <span class="teletype">.wat</span> files): see <a href="wasm_runtime" class="ocsimore_phrasing_link">Writing Wasm primitives</a>. If a js_of_ocaml projects uses some <span class="teletype">external</span> primitives defined in companion <span class="teletype">.js</span> files, it will need the same primitives to be implemented in Wasm module in order to be build with wasm_of_ocaml.</p></article></div></div></body></html>
