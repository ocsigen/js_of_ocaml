(jbuild_version 1)
(library
 ((name js_of_ocaml)
  (public_name js_of_ocaml)
  (libraries (uchar bytes js_of_ocaml-core))
  (flags (-open Js_of_ocaml_core))
  (wrapped false)
  (c_names (js_of_ocaml_stubs))
  (preprocess (pps (ppx_js)))))

(rule
 ((targets (js_of_ocaml_stubs.c))
  (deps ((file ../../tools/generate_stubs.sh)(glob_files *.ml)))
  (action (with-stdout-to ${@}
           (run ../../tools/generate_stubs.sh)))
  ))
