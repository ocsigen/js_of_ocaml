<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Ocamlbuild_js_of_ocaml (js_of_ocaml-ocamlbuild.Ocamlbuild_js_of_ocaml)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">js_of_ocaml-ocamlbuild</a> &#x00BB; Ocamlbuild_js_of_ocaml</nav><h1>Module <code>Ocamlbuild_js_of_ocaml</code></h1><p>Ocamlbuild plugin to build with js_of_ocaml</p><nav class="toc"><ul><li><a href="#initialize">Initialize</a><ul><li><a href="#with-oasis">With Oasis</a></li></ul></li><li><a href="#build">Build</a></li><li><a href="#options">Options</a><ul><li><a href="#exemples">Exemples</a></li></ul></li><li><a href="#dispatchers">Dispatchers</a></li><li><a href="#low-level-functions">Low level functions</a></li></ul></nav></header><section><header><h3 id="initialize"><a href="#initialize" class="anchor"></a>Initialize</h3><p>Initialize the js_of_ocaml ocamlbuild plugin with the following code in <i>myocamlbuild.ml</i>:</p><pre><code class="ml">let _ = Ocamlbuild_plugin.dispatch Ocamlbuild_js_of_ocaml.dispatcher</code></pre><p><b>Side note</b>: <span class="xref-unresolved" title="unresolved reference to &quot;Ocamlbuild_plugin.dispatch&quot;"><code>Ocamlbuild_plugin</code>.dispatch</span> should be used only once. The last call will override previous ones.</p></header><section><header><h4 id="with-oasis"><a href="#with-oasis" class="anchor"></a>With Oasis</h4><p>If you use oasis, <b>myocamlbuild.ml</b> should look like:</p><pre><code class="ml">let _ =
  Ocamlbuild_plugin.dispatch
    (fun hook -&gt;
       dispatch_default hook;
       Ocamlbuild_js_of_ocaml.dispatcher
         ~oasis_executables:[&quot;src/yourprogram.byte&quot;]
         hook;
    )</code></pre></header></section></section><section><header><h3 id="build"><a href="#build" class="anchor"></a>Build</h3><p>Build a JavaScript program <b>myprog.js</b> by calling the command:</p><pre><code class="ml">ocamlbuild -use-ocamlfind -plugin-tag &quot;package(js_of_ocaml.ocamlbuild)&quot; myprog.js</code></pre><p>It will first build the bytecode <b>myprog.byte</b> and finally produce <b>myprog.js</b> (in <b>_build</b>).</p></header></section><section><header><h3 id="options"><a href="#options" class="anchor"></a>Options</h3><p>One can pass option to the Js_of_ocaml compiler using tags. See &lt;&lt;a_manual chapter=&quot;options&quot; |Options&gt;&gt;.</p><p>Available tags:</p><ul><li><b>pretty</b>: Pretty print the generated javascript.</li><li><b>debuginfo</b>: Output debug information.</li><li><b>noinline</b>: Disable inlining</li><li><b>sourcemap</b>: Generate sourcemap</li><li><b>tailcall(none)</b>: Set the tailcall optimisation (default &quot;trampoline&quot;)</li><li><b>opt(3)</b>: Set the compilation profile (default 1)</li><li><b>debug</b>: enables <b>pretty</b>, <b>debuginfo</b>, <b>sourcemap</b></li></ul></header><section><header><h4 id="exemples"><a href="#exemples" class="anchor"></a>Exemples</h4><p>In the <b>_tags</b> file:</p><pre><code class="ml">&lt;myprog.js&gt;:pretty, opt(3)</code></pre></header></section></section><section><header><h3 id="dispatchers"><a href="#dispatchers" class="anchor"></a>Dispatchers</h3></header><dl><dt class="spec value" id="val-dispatcher"><a href="#val-dispatcher" class="anchor"></a><code><span class="keyword">val</span> dispatcher : <span>?&#8288;oasis_executables:<span>Ocamlbuild_plugin.Pathname.t list</span></span> <span>&#45;&gt;</span> Ocamlbuild_plugin.hook <span>&#45;&gt;</span> unit</code></dt><dd><p>The main dispatcher</p><p><code>?oasis_executables</code> is the paths of the executables (having the .byte extension) you want to compile as a javascript executable. The former executables are still compiled.</p><p>Side note: <span class="xref-unresolved" title="unresolved reference to &quot;Ocamlbuild_plugin.dispatch&quot;"><code>Ocamlbuild_plugin</code>.dispatch</span> should be used only once as it record only one function for an ocamlbuild module.</p></dd></dl></section><section><header><h3 id="low-level-functions"><a href="#low-level-functions" class="anchor"></a>Low level functions</h3></header><dl><dt class="spec value" id="val-oasis_support"><a href="#val-oasis_support" class="anchor"></a><code><span class="keyword">val</span> oasis_support : <span>executables:<span>Ocamlbuild_plugin.Pathname.t list</span></span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Map each targets given as argument to ocamlbuild and replace each element that exists in <code>~executables</code> by its corresponding .js target.</p></dd></dl></section></div></body></html>