<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title> Link with JavaScript code</title><meta charset="utf8"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="stylesheet" href="/css/style.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/themes/prism.min.css"/><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-ocaml.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-clike.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-reason.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-javascript.min.js"></script><script src="/js/client.js"></script></head><body class="js_of_ocaml 2.8.1 linker"><div class="project-page"><div class="page-header"><p class="logo-ocsigen"><a href="/" class="ocsimore_phrasing_link"><img src="/img/ocsigen-white.svg" alt="Ocsigen"/></a>
</p><p class="logo-subproject">Js_of_ocaml
</p><ul class="mainmenu"><li class="mainmenu-home"><a href="/" class="ocsimore_phrasing_link">Home</a>
</li><li class="mainmenu-doc"><a href="/tuto/6.2/manual/intro" class="ocsimore_phrasing_link">Doc</a>
</li><li><a href="/eliom/6.3/manual/intro" class="ocsimore_phrasing_link">Eliom</a>
</li><li class="mainmenu-current"><a href="/js_of_ocaml/3.1.0/manual/overview" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li><a href="/lwt/3.2.1/manual/manual" class="ocsimore_phrasing_link">Lwt</a>
</li><li><a href="/tyxml/4.1.0/manual/intro" class="ocsimore_phrasing_link">Tyxml</a>
</li><li><a href="/ocsigen-start/1.1.0/manual/intro" class="ocsimore_phrasing_link">Start</a>
</li></ul><div class="how-drawer"><input id="how-drawer-toggle" type="checkbox"/><label for="how-drawer-toggle" id="how-drawer-label"><span class="how-drawer-icon"></span></label><nav class="how-drawer-content"><ul class="drawermainmenu"><li class="drawermainmenu-home"><a href="/" class="ocsimore_phrasing_link">Home</a>
</li><li class="drawermainmenu-doc"><a href="/tuto/6.2/manual/intro" class="ocsimore_phrasing_link">Doc</a>
</li><li class="drawermainmenu-project"><a href="/eliom/6.3/manual/intro" class="ocsimore_phrasing_link">Eliom</a>
</li><li class="drawermainmenu-current drawermainmenu-project"><a href="/js_of_ocaml/3.1.0/manual/overview" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li class="drawermainmenu-project"><a href="/ocsigenserver/2.9/manual/quickstart" class="ocsimore_phrasing_link">Server</a>
</li><li class="drawermainmenu-project"><a href="/lwt/3.2.1/manual/manual" class="ocsimore_phrasing_link">Lwt</a>
</li><li class="drawermainmenu-project"><a href="/tyxml/4.1.0/manual/intro" class="ocsimore_phrasing_link">Tyxml</a>
</li><li class="drawermainmenu-project"><a href="/ocsigen-toolkit/1.1.0/manual/intro" class="ocsimore_phrasing_link">Toolkit</a>
</li><li class="drawermainmenu-project"><a href="/ocsigen-start/1.1.0/manual/intro" class="ocsimore_phrasing_link">Start</a>
</li><li class="drawermainmenu-page"><a href="/projects" class="ocsimore_phrasing_link">Other projects</a>
</li><li class="drawermainmenu-page"><a href="/papers" class="ocsimore_phrasing_link">Research papers</a>
</li><li class="drawermainmenu-page"><a href="/credits" class="ocsimore_phrasing_link">Who does Ocsigen?</a>
</li><li class="drawermainmenu-page"><a href="/blog" class="ocsimore_phrasing_link">Blog</a>
</li><li class="drawermainmenu-page"><a href="https://github.com/ocsigen" class="ocsimore_phrasing_link">Source code</a>
</li></ul><div class="how-doctree"><h1>Js_of_ocaml</h1><h2><a href="/js_of_ocaml/2.8.1/manual/overview" class="ocsimore_phrasing_link">Overview</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/library" class="ocsimore_phrasing_link">Library overview</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/bindings" class="ocsimore_phrasing_link">Binding a JS library</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/export" class="ocsimore_phrasing_link">Export OCaml code to JavaScript</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/core_async_kernel" class="ocsimore_phrasing_link">Core_kernel and Async_kernel</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/linker" class="ocsimore_phrasing_link">Link javascript code</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/options" class="ocsimore_phrasing_link">Command line options</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/performances" class="ocsimore_phrasing_link">Performances</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/debug" class="ocsimore_phrasing_link">Debug with js_of_ocaml</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/tailcall" class="ocsimore_phrasing_link">About tailcall optimization</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/camlp4" class="ocsimore_phrasing_link">Camlp4 syntax extension</a></h2><h2>Examples</h2><h3><span><a href="/js_of_ocaml/2.8.1/manual/files/toplevel/index.html" class="ocsforge_doclink_js_of_ocaml">An OCaml toplevel running in the browser</a></span></h3><h3><span><a href="/js_of_ocaml/2.8.1/manual/files/planet/index.html" class="ocsforge_doclink_js_of_ocaml">An animated 3D view of the Earth</a></span></h3><h3><span><a href="/js_of_ocaml/2.8.1/manual/files/graph_viewer/index.html" class="ocsforge_doclink_js_of_ocaml">A graph viewer</a></span></h3><h3><span><a href="/js_of_ocaml/2.8.1/manual/files/boulderdash/index.html" class="ocsforge_doclink_js_of_ocaml">A Boulder Dash game</a></span></h3><h3><span><a href="/js_of_ocaml/2.8.1/manual/files/wiki/index.html" class="ocsforge_doclink_js_of_ocaml">A realtime wiki editor</a></span></h3><h3><span><a href="/js_of_ocaml/2.8.1/manual/files/webgl/index.html" class="ocsforge_doclink_js_of_ocaml">A webgl demo</a></span></h3><h3><span><a href="/js_of_ocaml/2.8.1/manual/files/minesweeper/index.html" class="ocsforge_doclink_js_of_ocaml">A Minesweeper game</a></span></h3><h3><span><a href="/js_of_ocaml/2.8.1/manual/files/hyperbolic/index.html" class="ocsforge_doclink_js_of_ocaml">A hyperbolic tree viewer</a></span></h3><h3><span><a href="/js_of_ocaml/2.8.1/manual/files/cubes/index.html" class="ocsforge_doclink_js_of_ocaml">A random walk on lozenge tiling configurations</a></span></h3></div></nav></div></div><button id="reason">Switch to </button><div class="twocols"><div class="leftcol"><div class="how-versions"><input id="how-versions-toggle" type="checkbox"/><label for="how-versions-toggle" class="how-versions-current">Version 2.8.1</label><div class="how-versions-all"><a href="/js_of_ocaml/dev/manual/linker">dev</a><a href="/js_of_ocaml/3.1.0/manual/linker">3.1.0</a><a href="/js_of_ocaml/2.8.4/manual/linker">2.8.4</a><a href="/js_of_ocaml/2.8.3/manual/linker">2.8.3</a><a href="/js_of_ocaml/2.8.2/manual/linker">2.8.2</a><span class="how-versions-all-current">2.8.1</span><a href="/js_of_ocaml/2.8/manual/linker">2.8</a><a href="/js_of_ocaml/2.7/manual/linker">2.7</a><a href="/js_of_ocaml/2.6/manual/linker">2.6</a><a href="/js_of_ocaml/2.5/manual/linker">2.5</a><a href="/js_of_ocaml/2.4.1/manual/linker">2.4.1</a><a href="/js_of_ocaml/2.4/manual/linker">2.4</a><a href="/js_of_ocaml/2.3/manual/linker">2.3</a><a href="/js_of_ocaml/2.2/manual/linker">2.2</a><a href="/js_of_ocaml/2.1/manual/linker">2.1</a><a href="/js_of_ocaml/2.0/manual/linker">2.0</a><a href="/js_of_ocaml/1.4/manual/linker">1.4</a><a href="/js_of_ocaml/1.3/manual/linker">1.3</a><a href="/js_of_ocaml/1.2/manual/linker">1.2</a><a href="/js_of_ocaml/1.1.1/manual/linker">1.1.1</a><a href="/js_of_ocaml/1.0.9/manual/linker">1.0.9</a></div></div><form id="search"><input name="q" id="q" placeholder="search ..."/><button>Search</button></form><div class="how-doctree"><h1>Js_of_ocaml</h1><h2><a href="/js_of_ocaml/2.8.1/manual/overview" class="ocsimore_phrasing_link">Overview</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/library" class="ocsimore_phrasing_link">Library overview</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/bindings" class="ocsimore_phrasing_link">Binding a JS library</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/export" class="ocsimore_phrasing_link">Export OCaml code to JavaScript</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/core_async_kernel" class="ocsimore_phrasing_link">Core_kernel and Async_kernel</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/linker" class="ocsimore_phrasing_link">Link javascript code</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/options" class="ocsimore_phrasing_link">Command line options</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/performances" class="ocsimore_phrasing_link">Performances</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/debug" class="ocsimore_phrasing_link">Debug with js_of_ocaml</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/tailcall" class="ocsimore_phrasing_link">About tailcall optimization</a></h2><h2><a href="/js_of_ocaml/2.8.1/manual/camlp4" class="ocsimore_phrasing_link">Camlp4 syntax extension</a></h2><h2>Examples</h2><h3><span><a href="/js_of_ocaml/2.8.1/manual/files/toplevel/index.html" class="ocsforge_doclink_js_of_ocaml">An OCaml toplevel running in the browser</a></span></h3><h3><span><a href="/js_of_ocaml/2.8.1/manual/files/planet/index.html" class="ocsforge_doclink_js_of_ocaml">An animated 3D view of the Earth</a></span></h3><h3><span><a href="/js_of_ocaml/2.8.1/manual/files/graph_viewer/index.html" class="ocsforge_doclink_js_of_ocaml">A graph viewer</a></span></h3><h3><span><a href="/js_of_ocaml/2.8.1/manual/files/boulderdash/index.html" class="ocsforge_doclink_js_of_ocaml">A Boulder Dash game</a></span></h3><h3><span><a href="/js_of_ocaml/2.8.1/manual/files/wiki/index.html" class="ocsforge_doclink_js_of_ocaml">A realtime wiki editor</a></span></h3><h3><span><a href="/js_of_ocaml/2.8.1/manual/files/webgl/index.html" class="ocsforge_doclink_js_of_ocaml">A webgl demo</a></span></h3><h3><span><a href="/js_of_ocaml/2.8.1/manual/files/minesweeper/index.html" class="ocsforge_doclink_js_of_ocaml">A Minesweeper game</a></span></h3><h3><span><a href="/js_of_ocaml/2.8.1/manual/files/hyperbolic/index.html" class="ocsforge_doclink_js_of_ocaml">A hyperbolic tree viewer</a></span></h3><h3><span><a href="/js_of_ocaml/2.8.1/manual/files/cubes/index.html" class="ocsforge_doclink_js_of_ocaml">A random walk on lozenge tiling configurations</a></span></h3></div></div><div class="rightcol"><h1> Link with JavaScript code</h1><p>The Js_of_ocaml compiler accepts JavaScript files provided on the command-line.
The main purpose is to provide (external) primitives needed by the bytecode program.
</p><p>Most of the primitives from the standard library are already implemented and loaded by default (located in &quot;runtime.js&quot;).
</p><p>Additionally, some other primitives are installed but not loaded by default:
</p><ul><li> &quot;+weak.js&quot;  : when using weak references (does no follow the weak semantic)
</li><li> &quot;+toplevel.js&quot; : when compiling toplevel
</li></ul><h2> Command-line</h2><p>Pass the JavaScript file (must have a &quot;.js&quot; extension)
</p><pre><code>js_of_ocaml jsfile.js a.byte</code></pre><p>Or load it from a findlib package
</p><pre><code>js_of_ocaml +mypackage/jsfile.js a.byte</code></pre><p>The file <strong>jsfile.js</strong> will be looked up inside <strong>mypackage</strong> lib directory.
When no package is provided, the compiler will look inside js_of_ocaml lib directory.
</p><h2> Provide your own JavaScript</h2><p>You may need to provide extra JavaScript files to provide missing primitives or to override existing ones.
Primitive code must be annotated with the primitive name and primitive requirements.
The linker uses these information to only include the primitive actually used in the program and to perform better deadcode elimination.
</p><h3>Syntax</h3><pre>//Provides: primitive_name [const|mutable]
//Requires: primitive_name[,primitive_name]*
//Version: version_constraint[,version_constraint]*

function primitive_name(..){
 ... JavaScript code ...
}
</pre><ul><li> <strong><span class="teletype">//Provides</span></strong> is used to declare a primitive; an annotation
can be used to specify the possible side-effects of the primitive:
<ul><li>const<strong> means no side-effect; </strong>mutable<strong> indicates that the
primitive has no side-effect but that other primitives might affect
the returned value of the primitive; when no annotation is provided,
the linker assumes that the primitive may have side-effects.
</strong></li></ul></li><li> <strong><span class="teletype">//Requires</span></strong> is used if other primitives need to be loaded first
</li><li> <strong>version_constraint</strong> looks like &quot;<span class="teletype">&lt; 4.02.1</span>&quot;
</li><li> <strong><span class="teletype">//Version</span></strong> is optional and is rarely used
All JavaScript code following a <strong><span class="teletype">//Provides</span></strong> annotation is associated to this annotation, until the next <strong><span class="teletype">//Provides</span></strong> annotation.
</li></ul></div></div></div></body></html>
