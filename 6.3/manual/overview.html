<html><head><title> Js_of_ocaml</title><meta charset="utf8"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="stylesheet" href="https://ocsigen.org/css/style.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/themes/prism.min.css"/><script type="application/javascript" src="https://ocsigen.org/js/client.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-core.min.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-ocaml.min.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-clike.min.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-reason.min.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-javascript.min.js">
//<![CDATA[

//]]>
</script></head><body class="overview js_of_ocaml"><div class="project-page"><div class="page-header"><p class="logo-ocsigen"><a href=".././../../" class="ocsimore_phrasing_link"><img src=".././../../img/ocsigen-white.svg" alt="Ocsigen"/></a>
</p><p class="logo-subproject">Js_of_ocaml</p><div class="mainmenu"><p class="mainmenu-home"><a href=".././../../" class="ocsimore_phrasing_link">Home</a></p><p class="mainmenu-doc"><a href=".././../../tuto/" class="ocsimore_phrasing_link">Doc</a></p><p><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a></p><p class="mainmenu-current"><a href=".././../../js_of_ocaml/" class="ocsimore_phrasing_link">Js_of_ocaml</a></p><p><a href=".././../../ocsigenserver/" class="ocsimore_phrasing_link">Server</a></p><p><a href=".././../../lwt/" class="ocsimore_phrasing_link">Lwt</a></p><p><a href=".././../../tyxml/" class="ocsimore_phrasing_link">Tyxml</a></p><p><a href=".././../../ocsigen-start/" class="ocsimore_phrasing_link">Start</a></p></div><form id="googlesearch" action="https://google.com/search"><input name="q" id="gsearch-box" placeholder="Search using Google"/><label for="gsearch-box"><img src="/img/search.svg" alt="" id="gsearch-icon"/></label><input type="submit" id="gsearch-submit" onclick="document.getElementById('gsearch-box').value += ' site:ocsigen.org';"/></form><aside class="how-drawer"><input id="how-drawer-toggle" type="checkbox"/><label for="how-drawer-toggle" id="how-drawer-label"><span class="how-drawer-icon"></span></label><nav class="how-drawer-content"><ul class="drawermainmenu"><li class="drawermainmenu-home"><a href=".././../../" class="ocsimore_phrasing_link">Home</a>
</li><li class="drawermainmenu-doc"><a href=".././../../tuto/" class="ocsimore_phrasing_link">Doc</a>
</li><li class="drawermainmenu-project"><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a>
</li><li class="drawermainmenu-project"><a href=".././../../js_of_ocaml/" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigenserver/" class="ocsimore_phrasing_link">Server</a>
</li><li class="drawermainmenu-project"><a href=".././../../lwt/" class="ocsimore_phrasing_link">Lwt</a>
</li><li class="drawermainmenu-project"><a href=".././../../tyxml/" class="ocsimore_phrasing_link">Tyxml</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigen-toolkit/" class="ocsimore_phrasing_link">Toolkit</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigen-start/" class="ocsimore_phrasing_link">Start</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsipersist/" class="ocsimore_phrasing_link">Ocsipersist</a>
</li><li class="drawermainmenu-project"><a href=".././../../html_of_wiki/" class="ocsimore_phrasing_link">html_of_wiki</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsimore/" class="ocsimore_phrasing_link">Ocsimore (<em>deprecated</em>)</a>
</li><li class="drawermainmenu-page"><a href=".././../../projects" class="ocsimore_phrasing_link">Other projects</a>
</li><li class="drawermainmenu-page"><a href=".././../../papers" class="ocsimore_phrasing_link">Research papers</a>
</li><li class="drawermainmenu-page"><a href=".././../../credits" class="ocsimore_phrasing_link">Who does Ocsigen?</a>
</li><li class="drawermainmenu-page"><a href=".././../../contributing" class="ocsimore_phrasing_link">Contributing</a>
</li><li class="drawermainmenu-page"><a href=".././../../blog" class="ocsimore_phrasing_link">Blog</a>
</li><li class="drawermainmenu-page"><a href=".././../../install" class="ocsimore_phrasing_link">Installation</a>
</li><li class="drawermainmenu-page"><a href="https://github.com/ocsigen" class="ocsimore_phrasing_link">Source code</a>
</li></ul><nav class="how-doctree"><h2>Getting Started</h2><h3><a href="overview" class="ocsimore_phrasing_link">Overview</a></h3><h3><a href="install" class="ocsimore_phrasing_link">Installation</a></h3><h3><a href="quickstart" class="ocsimore_phrasing_link">Quick Start</a></h3><h2>Programming Guide</h2><h3><a href="javascript-interop" class="ocsimore_phrasing_link">JavaScript interop</a></h3><h3><a href="ppx" class="ocsimore_phrasing_link">PPX syntax extension</a></h3><h3><a href="ppx-deriving" class="ocsimore_phrasing_link">JSON derivation</a></h3><h3><a href="rev-bindings" class="ocsimore_phrasing_link">Export OCaml code to JavaScript</a></h3><h3><a href="errors" class="ocsimore_phrasing_link">Error handling</a></h3><h3><span><a href=".././api/js_of_ocaml/">API</a></span></h3><h2>Lwt Support</h2><h3><a href="lwt" class="ocsimore_phrasing_link">Lwt support</a></h3><h3><span><a href=".././api/js_of_ocaml-lwt/">API</a></span></h3><h2>Compiler</h2><h3><a href="options" class="ocsimore_phrasing_link">Command line options</a></h3><h3><a href="compilation-modes" class="ocsimore_phrasing_link">Compilation modes</a></h3><h3><a href="linker" class="ocsimore_phrasing_link">JavaScript primitives</a></h3><h3><a href="tailcall" class="ocsimore_phrasing_link">Tailcall optimization</a></h3><h3><a href="effects" class="ocsimore_phrasing_link">Effect handlers</a></h3><h3><a href="runtime-representation" class="ocsimore_phrasing_link">Runtime representation</a></h3><h2>Wasm_of_ocaml</h2><h3><a href="wasm_overview" class="ocsimore_phrasing_link">Overview</a></h3><h3><a href="wasm_runtime" class="ocsimore_phrasing_link">Writing Wasm primitives</a></h3><h2>How-to Guides</h2><h3><a href="build-toplevel" class="ocsimore_phrasing_link">Build a toplevel or use Dynlink</a></h3><h3><a href="debug" class="ocsimore_phrasing_link">Debug a program</a></h3><h3><a href="performances" class="ocsimore_phrasing_link">Performance</a></h3><h3><a href="contribute" class="ocsimore_phrasing_link">Contribute</a></h3><h2>Try it</h2><h3><span><a href=".././manual/files/toplevel/index.html">OCaml toplevel</a></span></h3><h3><a href="examples" class="ocsimore_phrasing_link">Examples and projects</a></h3></nav></nav></aside></div><p class="reasonwarning">Warning: Reason support is experimental.
We are looking for beta-tester and contributors.
</p><button id="reason">Switch to </button><div class="twocols"><nav class="leftcol">Version <select class="how-versions" onchange="location = this.value;"><option value=".././../dev/manual/overview">dev</option><option value=".././../6.3/manual/overview" selected="selected">6.3</option><option value=".././../6.2.0/manual/overview">6.2.0</option><option value=".././../6.1.0/manual/overview">6.1.0</option><option value=".././../6.0.1/manual/overview">6.0.1</option><option value=".././../5.9.1/manual/overview">5.9.1</option><option value=".././../5.8.2/manual/overview">5.8.2</option><option value=".././../5.7.2/manual/overview">5.7.2</option><option value=".././../5.6.0/manual/overview">5.6.0</option><option value=".././../5.5.2/manual/overview">5.5.2</option><option value=".././../5.4.0/manual/overview">5.4.0</option><option value=".././../5.3.0/manual/overview">5.3.0</option><option value=".././../5.2.0/manual/overview">5.2.0</option><option value=".././../5.1.0/manual/overview">5.1.0</option><option value=".././../5.0.1/manual/overview">5.0.1</option><option value=".././../4.1.0/manual/overview">4.1.0</option><option value=".././../4.0.0/manual/overview">4.0.0</option><option value=".././../3.11.0/manual/overview">3.11.0</option><option value=".././../3.10.0/manual/overview">3.10.0</option><option value=".././../3.9.0/manual/overview">3.9.0</option><option value=".././../3.8.0/manual/overview">3.8.0</option><option value=".././../3.7.0/manual/overview">3.7.0</option><option value=".././../3.6.0/manual/overview">3.6.0</option><option value=".././../3.5.1/manual/overview">3.5.1</option></select><nav class="how-doctree"><h2>Getting Started</h2><h3><a href="overview" class="ocsimore_phrasing_link">Overview</a></h3><h3><a href="install" class="ocsimore_phrasing_link">Installation</a></h3><h3><a href="quickstart" class="ocsimore_phrasing_link">Quick Start</a></h3><h2>Programming Guide</h2><h3><a href="javascript-interop" class="ocsimore_phrasing_link">JavaScript interop</a></h3><h3><a href="ppx" class="ocsimore_phrasing_link">PPX syntax extension</a></h3><h3><a href="ppx-deriving" class="ocsimore_phrasing_link">JSON derivation</a></h3><h3><a href="rev-bindings" class="ocsimore_phrasing_link">Export OCaml code to JavaScript</a></h3><h3><a href="errors" class="ocsimore_phrasing_link">Error handling</a></h3><h3><span><a href=".././api/js_of_ocaml/">API</a></span></h3><h2>Lwt Support</h2><h3><a href="lwt" class="ocsimore_phrasing_link">Lwt support</a></h3><h3><span><a href=".././api/js_of_ocaml-lwt/">API</a></span></h3><h2>Compiler</h2><h3><a href="options" class="ocsimore_phrasing_link">Command line options</a></h3><h3><a href="compilation-modes" class="ocsimore_phrasing_link">Compilation modes</a></h3><h3><a href="linker" class="ocsimore_phrasing_link">JavaScript primitives</a></h3><h3><a href="tailcall" class="ocsimore_phrasing_link">Tailcall optimization</a></h3><h3><a href="effects" class="ocsimore_phrasing_link">Effect handlers</a></h3><h3><a href="runtime-representation" class="ocsimore_phrasing_link">Runtime representation</a></h3><h2>Wasm_of_ocaml</h2><h3><a href="wasm_overview" class="ocsimore_phrasing_link">Overview</a></h3><h3><a href="wasm_runtime" class="ocsimore_phrasing_link">Writing Wasm primitives</a></h3><h2>How-to Guides</h2><h3><a href="build-toplevel" class="ocsimore_phrasing_link">Build a toplevel or use Dynlink</a></h3><h3><a href="debug" class="ocsimore_phrasing_link">Debug a program</a></h3><h3><a href="performances" class="ocsimore_phrasing_link">Performance</a></h3><h3><a href="contribute" class="ocsimore_phrasing_link">Contribute</a></h3><h2>Try it</h2><h3><span><a href=".././manual/files/toplevel/index.html">OCaml toplevel</a></span></h3><h3><a href="examples" class="ocsimore_phrasing_link">Examples and projects</a></h3></nav></nav><article class="rightcol"><h1> Js_of_ocaml</h1><h2 id="overview"> Overview <a class="backref" href="#overview">&#182;</a></h2><p>Js_of_ocaml is a compiler from OCaml bytecode programs to JavaScript.
It makes it possible to run pure OCaml programs in JavaScript environments
like browsers and Node.js. It is easy to install as it works with an
existing installation of OCaml, with no need to recompile any library.
It comes with bindings for a large part of the browser APIs.
</p><p>According to our benchmarks, the generated programs
<span><a href=".././manual/performances">run typically faster</a></span> than with
the OCaml bytecode interpreter. We believe this compiler will prove
much easier to maintain than a retargeted OCaml compiler, as the
bytecode provides a very stable API.
</p><p>Js_of_ocaml is composed of multiple packages:
</p><ul><li> <span class="teletype">js_of_ocaml-compiler</span> - the compiler
</li><li> <span class="teletype">js_of_ocaml-ppx</span> - ppx syntax extension
</li><li> <span class="teletype">js_of_ocaml</span> - the base library
</li><li> <span class="teletype">js_of_ocaml-ppx_deriving_json</span> - JSON derivation
</li><li> <span class="teletype">js_of_ocaml-lwt</span> - Lwt support
</li><li> <span class="teletype">js_of_ocaml-tyxml</span> - TyXML support
</li><li> <span class="teletype">js_of_ocaml-toplevel</span> - tools to <span><a href=".././manual/build-toplevel">build an OCaml toplevel</a></span>
</li></ul><p>There is also a compiler targeting WebAssembly provided by the
<span class="teletype">wasm_of_ocaml</span> package. See <span><a href=".././manual/wasm_overview">wasm_of_ocaml</a></span>.
</p><p><strong>Note</strong>: All code examples in this manual use Js_of_ocaml's ppx syntax.
It is possible to use Js_of_ocaml purely as a compiler while using a
different package (e.g., gen_js_api, brr) to provide bindings to the browser APIs.
</p><h2 id="installation"> Installation <a class="backref" href="#installation">&#182;</a></h2><p>The easiest way to install js_of_ocaml is to use opam:
</p><pre>opam install js_of_ocaml js_of_ocaml-ppx js_of_ocaml-lwt
</pre><p>For alternatives, see <span><a href=".././manual/install">Installation</a></span>.
</p><h2 id="usage"> Usage <a class="backref" href="#usage">&#182;</a></h2><p>Your program must first be compiled using the OCaml bytecode compiler <span class="teletype">ocamlc</span>.
JavaScript bindings are provided by the <span class="teletype">js_of_ocaml</span> package and the
syntax extension by the <span class="teletype">js_of_ocaml-ppx</span> package:
</p><pre>ocamlfind ocamlc -package js_of_ocaml -package js_of_ocaml-ppx \
    -linkpkg -o cubes.byte cubes.ml
</pre><p>Then, run the <span class="teletype">js_of_ocaml</span> compiler to produce JavaScript code:
</p><pre>js_of_ocaml cubes.byte
</pre><p><strong>Note</strong>: Generated JavaScript files are UTF-8 encoded.
</p><h3> With dune</h3><p>Dune has native support for js_of_ocaml. It supports both standard and
separate compilation of JavaScript files. See <a href="https://dune.readthedocs.io/en/latest/jsoo.html" class="ocsimore_phrasing_link">https://dune.readthedocs.io/en/latest/jsoo.html</a>
</p><h3> With ocamlbuild (legacy)</h3><p>Js_of_ocaml provides an ocamlbuild plugin. See
<a href="https://github.com/ocsigen/js_of_ocaml-ocamlbuild" class="ocsimore_phrasing_link">js_of_ocaml-ocamlbuild</a>.
</p><h3> Toplevel</h3><p>You can find an OCaml toplevel running in the browser <span><a href=".././manual/files/toplevel/index.html">here</a></span>.
See <span><a href=".././manual/build-toplevel">Building a toplevel</a></span> to create your own.
</p><h2 id="supported-features"> Supported features <a class="backref" href="#supported-features">&#182;</a></h2><p>Most of the OCaml standard library is supported. However:
</p><ul><li> Most of the <span class="teletype">Sys</span> module is not supported
</li></ul><p>Extra libraries distributed with OCaml (such as Thread) are not
supported in general. However:
</p><ul><li> <span class="teletype">Bigarray</span> - supported using Typed Arrays
</li><li> <span class="teletype">Num</span> - supported
</li><li> <span class="teletype">Str</span> - supported
</li><li> <span class="teletype">Graphics</span> - partially supported using canvas (see also <span class="teletype">js_of_ocaml-lwt.graphics</span>)
</li><li> <span class="teletype">Unix</span> - time-related functions are supported
</li></ul><h3> Tail call optimization</h3><p>Tail calls are not optimized in general. However, mutually recursive
functions are optimized:
</p><ul><li> Self-recursive functions (when the tail calls are the function itself) are compiled using a loop
</li><li> Trampolines are used otherwise
</li></ul><p>See <span><a href=".././manual/tailcall">tailcall optimization</a></span> for more details.
</p><h3> Effect handlers</h3><p>Effect handlers are fully supported with the <span class="teletype">--effects=..</span> flag.
Effect support is disabled by default since effects are not widely used
and the generated code can be slower, larger, and less readable.
See <span><a href=".././manual/effects">effect handlers</a></span> for details.
</p><h3> Data representation</h3><p>Data representation differs from the usual OCaml runtime:
</p><ul><li> Integers are 32 bits (rather than 31 or 63 bits), their natural size in JavaScript
</li><li> Floats are not boxed
</li></ul><p>As a consequence, marshalling, polymorphic comparison, and hashing functions
can yield different results:
</p><ul><li> Marshalling floats might generate different output (do not unmarshal with the standard OCaml runtime)
</li><li> The polymorphic hash function will not give the same results on data structures containing floats
</li><li> These functions may be more prone to stack overflow
</li></ul><p><strong>Note</strong>: Float rounding is slightly different between native and JavaScript.
Both round to nearest but resolve ties differently: JavaScript resolves ties
away from zero while libc resolves ties to even.
</p><p>See <span><a href=".././manual/runtime-representation">runtime representation</a></span> for details.</p></article></div></div></body></html>
