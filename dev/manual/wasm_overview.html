<html><head><title> Wasm_of_ocaml</title><meta charset="utf8"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="stylesheet" href="https://ocsigen.org/css/style.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/themes/prism.min.css"/><script type="application/javascript" src="https://ocsigen.org/js/client.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-core.min.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-ocaml.min.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-clike.min.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-reason.min.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-javascript.min.js">
//<![CDATA[

//]]>
</script></head><body class="wasm_overview js_of_ocaml"><div class="project-page"><div class="page-header"><p class="logo-ocsigen"><a href=".././../../" class="ocsimore_phrasing_link"><img src=".././../../img/ocsigen-white.svg" alt="Ocsigen"/></a>
</p><p class="logo-subproject">Js_of_ocaml</p><div class="mainmenu"><p class="mainmenu-home"><a href=".././../../" class="ocsimore_phrasing_link">Home</a></p><p class="mainmenu-doc"><a href=".././../../tuto/" class="ocsimore_phrasing_link">Doc</a></p><p><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a></p><p class="mainmenu-current"><a href=".././../../js_of_ocaml/" class="ocsimore_phrasing_link">Js_of_ocaml</a></p><p><a href=".././../../ocsigenserver/" class="ocsimore_phrasing_link">Server</a></p><p><a href=".././../../lwt/" class="ocsimore_phrasing_link">Lwt</a></p><p><a href=".././../../tyxml/" class="ocsimore_phrasing_link">Tyxml</a></p><p><a href=".././../../ocsigen-start/" class="ocsimore_phrasing_link">Start</a></p></div><form id="googlesearch" action="https://google.com/search"><input name="q" id="gsearch-box" placeholder="Search using Google"/><label for="gsearch-box"><img src="/img/search.svg" alt="" id="gsearch-icon"/></label><input type="submit" id="gsearch-submit" onclick="document.getElementById('gsearch-box').value += ' site:ocsigen.org';"/></form><aside class="how-drawer"><input id="how-drawer-toggle" type="checkbox"/><label for="how-drawer-toggle" id="how-drawer-label"><span class="how-drawer-icon"></span></label><nav class="how-drawer-content"><ul class="drawermainmenu"><li class="drawermainmenu-home"><a href=".././../../" class="ocsimore_phrasing_link">Home</a>
</li><li class="drawermainmenu-doc"><a href=".././../../tuto/" class="ocsimore_phrasing_link">Doc</a>
</li><li class="drawermainmenu-project"><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a>
</li><li class="drawermainmenu-project"><a href=".././../../js_of_ocaml/" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigenserver/" class="ocsimore_phrasing_link">Server</a>
</li><li class="drawermainmenu-project"><a href=".././../../lwt/" class="ocsimore_phrasing_link">Lwt</a>
</li><li class="drawermainmenu-project"><a href=".././../../tyxml/" class="ocsimore_phrasing_link">Tyxml</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigen-toolkit/" class="ocsimore_phrasing_link">Toolkit</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigen-start/" class="ocsimore_phrasing_link">Start</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsipersist/" class="ocsimore_phrasing_link">Ocsipersist</a>
</li><li class="drawermainmenu-project"><a href=".././../../html_of_wiki/" class="ocsimore_phrasing_link">html_of_wiki</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsimore/" class="ocsimore_phrasing_link">Ocsimore (<em>deprecated</em>)</a>
</li><li class="drawermainmenu-page"><a href=".././../../projects" class="ocsimore_phrasing_link">Other projects</a>
</li><li class="drawermainmenu-page"><a href=".././../../papers" class="ocsimore_phrasing_link">Research papers</a>
</li><li class="drawermainmenu-page"><a href=".././../../credits" class="ocsimore_phrasing_link">Who does Ocsigen?</a>
</li><li class="drawermainmenu-page"><a href=".././../../contributing" class="ocsimore_phrasing_link">Contributing</a>
</li><li class="drawermainmenu-page"><a href=".././../../blog" class="ocsimore_phrasing_link">Blog</a>
</li><li class="drawermainmenu-page"><a href=".././../../install" class="ocsimore_phrasing_link">Installation</a>
</li><li class="drawermainmenu-page"><a href="https://github.com/ocsigen" class="ocsimore_phrasing_link">Source code</a>
</li></ul><nav class="how-doctree"><h2>Getting Started</h2><h3><a href="overview" class="ocsimore_phrasing_link">Overview</a></h3><h3><a href="quickstart" class="ocsimore_phrasing_link">Quick Start</a></h3><h3><a href="install" class="ocsimore_phrasing_link">Installation</a></h3><h2>Programming Guide</h2><h3><a href="library" class="ocsimore_phrasing_link">Library overview</a></h3><h3><a href="bindings" class="ocsimore_phrasing_link">Binding a JS library</a></h3><h3><a href="rev-bindings" class="ocsimore_phrasing_link">Export OCaml code to JavaScript</a></h3><h3><a href="errors" class="ocsimore_phrasing_link">Error handling</a></h3><h3><span><a href=".././api/js_of_ocaml/">API</a></span></h3><h2>Syntaxes</h2><h3><a href="ppx" class="ocsimore_phrasing_link">Ppx syntax extension</a></h3><h3><a href="ppx-deriving" class="ocsimore_phrasing_link">Ppx deriving json</a></h3><h2>Lwt Support</h2><h3><a href="lwt" class="ocsimore_phrasing_link">Lwt support</a></h3><h3><span><a href=".././api/js_of_ocaml-lwt/">API</a></span></h3><h2>Compiler</h2><h3><a href="options" class="ocsimore_phrasing_link">Command line options</a></h3><h3><a href="linker" class="ocsimore_phrasing_link">Linking JavaScript code</a></h3><h3><a href="compilation-modes" class="ocsimore_phrasing_link">Compilation modes</a></h3><h3><a href="tailcall" class="ocsimore_phrasing_link">Tailcall optimization</a></h3><h3><a href="effects" class="ocsimore_phrasing_link">Effect handlers</a></h3><h2>Wasm_of_ocaml</h2><h3><a href="wasm_overview" class="ocsimore_phrasing_link">Overview</a></h3><h3><a href="wasm_runtime" class="ocsimore_phrasing_link">Writing Wasm primitives</a></h3><h2>How-to Guides</h2><h3><a href="build-toplevel" class="ocsimore_phrasing_link">Build a toplevel or use Dynlink</a></h3><h3><a href="debug" class="ocsimore_phrasing_link">Debug a program</a></h3><h3><a href="performances" class="ocsimore_phrasing_link">Performances</a></h3><h3><a href="contribute" class="ocsimore_phrasing_link">Contribute</a></h3><h2>Examples</h2><h3><span><a href=".././manual/files/toplevel/index.html">OCaml toplevel in the browser</a></span></h3><h3><span><a href=".././manual/files/planet/index.html">Animated 3D view of the Earth</a></span></h3><h3><span><a href=".././manual/files/graph_viewer/index.html">Graph viewer</a></span></h3><h3><span><a href=".././manual/files/boulderdash/index.html">Boulder Dash game</a></span></h3><h3><span><a href=".././manual/files/wiki/index.html">Realtime wiki editor</a></span></h3><h3><span><a href=".././manual/files/webgl/index.html">WebGL demo</a></span></h3><h3><span><a href=".././manual/files/minesweeper/index.html">Minesweeper game</a></span></h3><h3><span><a href=".././manual/files/hyperbolic/index.html">Hyperbolic tree viewer</a></span></h3><h3><span><a href=".././manual/files/cubes/index.html">Random walk on lozenge tilings</a></span></h3></nav></nav></aside></div><p class="reasonwarning">Warning: Reason support is experimental.
We are looking for beta-tester and contributors.
</p><button id="reason">Switch to </button><div class="twocols"><nav class="leftcol">Version <select class="how-versions" onchange="location = this.value;"><option value=".././../dev/manual/wasm_overview" selected="selected">dev</option><option value=".././../6.2.0/manual/wasm_overview">6.2.0</option><option value=".././../6.1.0/manual/wasm_overview">6.1.0</option><option value=".././../6.0.1/manual/wasm_overview">6.0.1</option><option value=".././../5.9.1/manual/wasm_overview">5.9.1</option><option value=".././../5.8.2/manual/wasm_overview">5.8.2</option><option value=".././../5.7.2/manual/wasm_overview">5.7.2</option><option value=".././../5.6.0/manual/wasm_overview">5.6.0</option><option value=".././../5.5.2/manual/wasm_overview">5.5.2</option><option value=".././../5.4.0/manual/wasm_overview">5.4.0</option><option value=".././../5.3.0/manual/wasm_overview">5.3.0</option><option value=".././../5.2.0/manual/wasm_overview">5.2.0</option><option value=".././../5.1.0/manual/wasm_overview">5.1.0</option><option value=".././../5.0.1/manual/wasm_overview">5.0.1</option><option value=".././../4.1.0/manual/wasm_overview">4.1.0</option><option value=".././../4.0.0/manual/wasm_overview">4.0.0</option><option value=".././../3.11.0/manual/wasm_overview">3.11.0</option><option value=".././../3.10.0/manual/wasm_overview">3.10.0</option><option value=".././../3.9.0/manual/wasm_overview">3.9.0</option><option value=".././../3.8.0/manual/wasm_overview">3.8.0</option><option value=".././../3.7.0/manual/wasm_overview">3.7.0</option><option value=".././../3.6.0/manual/wasm_overview">3.6.0</option><option value=".././../3.5.1/manual/wasm_overview">3.5.1</option></select><nav class="how-doctree"><h2>Getting Started</h2><h3><a href="overview" class="ocsimore_phrasing_link">Overview</a></h3><h3><a href="quickstart" class="ocsimore_phrasing_link">Quick Start</a></h3><h3><a href="install" class="ocsimore_phrasing_link">Installation</a></h3><h2>Programming Guide</h2><h3><a href="library" class="ocsimore_phrasing_link">Library overview</a></h3><h3><a href="bindings" class="ocsimore_phrasing_link">Binding a JS library</a></h3><h3><a href="rev-bindings" class="ocsimore_phrasing_link">Export OCaml code to JavaScript</a></h3><h3><a href="errors" class="ocsimore_phrasing_link">Error handling</a></h3><h3><span><a href=".././api/js_of_ocaml/">API</a></span></h3><h2>Syntaxes</h2><h3><a href="ppx" class="ocsimore_phrasing_link">Ppx syntax extension</a></h3><h3><a href="ppx-deriving" class="ocsimore_phrasing_link">Ppx deriving json</a></h3><h2>Lwt Support</h2><h3><a href="lwt" class="ocsimore_phrasing_link">Lwt support</a></h3><h3><span><a href=".././api/js_of_ocaml-lwt/">API</a></span></h3><h2>Compiler</h2><h3><a href="options" class="ocsimore_phrasing_link">Command line options</a></h3><h3><a href="linker" class="ocsimore_phrasing_link">Linking JavaScript code</a></h3><h3><a href="compilation-modes" class="ocsimore_phrasing_link">Compilation modes</a></h3><h3><a href="tailcall" class="ocsimore_phrasing_link">Tailcall optimization</a></h3><h3><a href="effects" class="ocsimore_phrasing_link">Effect handlers</a></h3><h2>Wasm_of_ocaml</h2><h3><a href="wasm_overview" class="ocsimore_phrasing_link">Overview</a></h3><h3><a href="wasm_runtime" class="ocsimore_phrasing_link">Writing Wasm primitives</a></h3><h2>How-to Guides</h2><h3><a href="build-toplevel" class="ocsimore_phrasing_link">Build a toplevel or use Dynlink</a></h3><h3><a href="debug" class="ocsimore_phrasing_link">Debug a program</a></h3><h3><a href="performances" class="ocsimore_phrasing_link">Performances</a></h3><h3><a href="contribute" class="ocsimore_phrasing_link">Contribute</a></h3><h2>Examples</h2><h3><span><a href=".././manual/files/toplevel/index.html">OCaml toplevel in the browser</a></span></h3><h3><span><a href=".././manual/files/planet/index.html">Animated 3D view of the Earth</a></span></h3><h3><span><a href=".././manual/files/graph_viewer/index.html">Graph viewer</a></span></h3><h3><span><a href=".././manual/files/boulderdash/index.html">Boulder Dash game</a></span></h3><h3><span><a href=".././manual/files/wiki/index.html">Realtime wiki editor</a></span></h3><h3><span><a href=".././manual/files/webgl/index.html">WebGL demo</a></span></h3><h3><span><a href=".././manual/files/minesweeper/index.html">Minesweeper game</a></span></h3><h3><span><a href=".././manual/files/hyperbolic/index.html">Hyperbolic tree viewer</a></span></h3><h3><span><a href=".././manual/files/cubes/index.html">Random walk on lozenge tilings</a></span></h3></nav></nav><article class="rightcol"><h1> Wasm_of_ocaml</h1><h2> Overview</h2><p>Wasm_of_ocaml is a compiler from OCaml bytecode programs to WebAssembly.
It provides an alternative way to run pure OCaml programs in JavaScript
environments like browsers and Node.js.
</p><p>The compiler is provided by the <span class="teletype">wasm_of_ocaml-compiler</span> package.
The <span><a href=".././manual/overview">Js_of_ocaml libraries</a></span> are compatible
with this compiler.
</p><h2> Installation</h2><p>The easiest way to install wasm_of_ocaml is to use opam:
</p><pre>opam install wasm_of_ocaml-compiler js_of_ocaml js_of_ocaml-ppx js_of_ocaml-lwt
</pre><p>Binaryen version 119 or later is required. The opam command above will
install it automatically if needed.
</p><h2> Usage</h2><p>Your program must first be compiled using the OCaml bytecode compiler <span class="teletype">ocamlc</span>.
JavaScript bindings are provided by the <span class="teletype">js_of_ocaml</span> package and the
syntax extension by the <span class="teletype">js_of_ocaml-ppx</span> package:
</p><pre>ocamlfind ocamlc -package js_of_ocaml -package js_of_ocaml-ppx \
    -linkpkg -o cubes.byte cubes.ml
</pre><p>Then, run the <span class="teletype">wasm_of_ocaml</span> compiler to produce Wasm code:
</p><pre>wasm_of_ocaml cubes.byte
</pre><p>This produces a JavaScript loading script <span class="teletype">cubes.js</span> and a directory
<span class="teletype">cubes.assets</span> containing the Wasm code.
</p><h3> With dune</h3><p>Dune has native support for wasm_of_ocaml (starting with dune 3.17.0).
It supports both standard and separate compilation.
See <a href="https://dune.readthedocs.io/en/latest/wasmoo.html" class="ocsimore_phrasing_link">https://dune.readthedocs.io/en/latest/wasmoo.html</a>
</p><h2> Supported features</h2><p>Most of the OCaml standard library is supported. However:
</p><ul><li> Most of the <span class="teletype">Sys</span> module is not supported
</li></ul><p>Extra libraries distributed with OCaml (such as Thread) are not
supported in general. However:
</p><ul><li> <span class="teletype">Bigarray</span> - supported using Typed Arrays
</li><li> <span class="teletype">Str</span> - supported
</li><li> <span class="teletype">Graphics</span> - partially supported using canvas (see also <span class="teletype">js_of_ocaml-lwt.graphics</span>)
</li><li> <span class="teletype">Unix</span> - time-related functions are supported
</li></ul><h3> Differences from js_of_ocaml</h3><p>Compared to js_of_ocaml:
</p><ul><li> Dynlink is not supported
</li><li> Building an OCaml toplevel is not possible
</li><li> The virtual filesystem is not implemented
</li></ul><h3> Effect handlers</h3><p>OCaml 5.x code using effect handlers can be compiled in two ways:
</p><ul><li> <strong><span class="teletype">--effects=cps</span></strong> - Uses the CPS transformation from js_of_ocaml
</li><li> <strong><span class="teletype">--effects=jspi</span></strong> (default) - Uses the <a href="https://github.com/WebAssembly/js-promise-integration" class="ocsimore_phrasing_link">JavaScript-Promise Integration extension</a>
</li></ul><p>The CPS transformation is not the default since the generated code is slower,
larger, and less readable. However, the JSPI extension is not yet enabled by
default in web browsers, and performing effects is slower when using it.
</p><h2> Binding with JavaScript libraries</h2><p>Js_of_ocaml lets you bind code with JavaScript libraries by linking <span class="teletype">.js</span> files.
Similarly, wasm_of_ocaml allows linking Wasm modules (<span class="teletype">.wasm</span> or <span class="teletype">.wat</span> files).
See <span><a href=".././manual/wasm_runtime">Writing Wasm primitives</a></span>.
</p><p>If a js_of_ocaml project uses <span class="teletype">external</span> primitives defined in companion
<span class="teletype">.js</span> files, you need to implement the same primitives in Wasm modules
to build with wasm_of_ocaml.</p></article></div></div></body></html>
